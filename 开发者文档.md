# 设备管理系统 - 开发者自定义文档

本文档用于指导开发人员快速自定义系统名词、下拉选项、表单字段和接口路径。

/**
 * 登录接口  在src/api/auth.ts
 * POST /auth/login
 */
  请求
 {
    "timestamp": "2025-11-25T12:00:00Z",
    "data": {
      "username": "用户名",
      "password": "密码"
    }
  }
  响应
  {
    "timestamp": "2025-11-25T12:00:00Z",
    "code": 200,
    "data": {
      "username": "用户名",
      "token": "token（可选）"
    }
  }


  <!-- 项目的启动 -->
  npm install
  npm run dev
  <!-- 项目的打包 -->
  npm run build
  <!--项目的node版本  -->
  20左右的都可以
  <!-- 我所使用的node版本  20.19.0 -->
---

## 目录

## 1.名词替换位置
## 2.下拉列表增删操作
## 3.所有表单字段名称
## 4. 所有按钮对应的接口路径
## 5.环境配置（模拟数据配置，环境变量，路由配置，菜单配置）
---

## 1. 名词替换位置

### 1.1 动作（Action）和子动作（SubAction）配置

**文件位置：** `src/data/mock.ts`

**当前配置：**
```typescript
// 第 135-143 行：动作选项列表
export const actionOptions = [
  '吃饭',
  '洗澡',
  '散步',
  '看电视',
  '运动',
  '工作',
  '休息',
]

// 第 145-153 行：子动作选项（根据动作动态变化）
export const subActionOptions: Record<string, string[]> = {
  吃饭: ['吃番茄炒蛋', '吃黄焖鸡米饭', '吃牛肉面'],
  洗澡: ['洗头', '泡澡', '快速冲澡'],
  散步: ['去街心公园', '小区周边', '江边'],
  看电视: ['新闻', '综艺', '纪录片'],
  运动: ['跑步', '瑜伽', '力量训练'],
  工作: ['远程会议', '整理报表', '代码编写'],
  休息: ['午休', '躺平', '闭目养神'],
}
```

**注意事项：**
- 修改 `actionOptions（动作）` 后，必须同步更新 `subActionOptions（子动作）` 中的 key
- 子动作数组中的值会显示在下拉列表中
- 这些配置会在以下页面使用：
  - 设备列表页：下发指令弹窗
  - 新建流程页：步骤配置表格
  - 流程管理页：编辑流程抽屉

---

## 2. 下拉列表增删操作

**步骤：**
1. 在 `src/data/mock.ts` 的 `actionOptions` 数组中添加新动作
2. 在 `subActionOptions` 对象中添加对应的子动作数组

**示例：**
```typescript
export const actionOptions = [
  '吃饭',
  '洗澡',
  '散步',
  '看电视',
  '运动',
  '工作',
  '休息',
  '新动作',  // ← 新增、删除
]

export const subActionOptions: Record<string, string[]> = {
  吃饭: ['吃番茄炒蛋', '吃黄焖鸡米饭', '吃牛肉面'],
  // ... 其他
  新动作: ['子动作1', '子动作2', '子动作3'],  // ← 新增对应子动作
}
```

---

## 3. 所有表单字段名称

### 3.1 设备列表页面 (`src/views/DeviceListView.vue`)

#### 3.1.1 添加设备表单
- **表单变量：** `addDeviceForm` (第 32-35 行)
- **字段列表：**
  - `serialNumber` - 序列号（必填）
  - `verificationCode` - 校验码（必填）

#### 3.1.2 下发指令表单
- **表单变量：** `commandForm` (第 37-43 行)
- **字段列表：**
  - `action` - 动作（下拉选择，必填）
  - `subAction` - 子动作（下拉选择，必填）
  - `start` - 开始时间（日期时间选择器，必填）
  - `end` - 结束时间（日期时间选择器，必填）
  - `remark` - 备注（文本域，可选）

#### 3.1.3 设备详情抽屉
- **显示字段：**
  - `serialNumber` - 序列号
  - `status` - 状态
  - `currentAction` - 当前动作
  - `nextAction.name` - 下一动作名称
  - `nextAction.start` - 下一动作开始时间
  - `nextAction.end` - 下一动作结束时间
  - `ip` - IP 地址
  - `traffic` - 流量统计
  - `location` - 所在地

### 3.2 新建流程页面 (`src/views/NewProcessView.vue`)

#### 3.2.1 流程基本信息
- **变量：** `processName` (第 33 行) - 流程名称
- **变量：** `processRemark` (第 34 行) - 备注

#### 3.2.2 流程步骤表格
- **变量：** `steps` (第 35 行) - 步骤数组
- **每个步骤包含字段：**
  - `step` - 步骤序号（自动生成）
  - `action` - 动作（下拉选择，必填）
  - `subAction` - 子动作（下拉选择，必填）
  - `startTime` - 开始时间（日期时间选择器，必填，格式：`YYYY-MM-DD HH:mm`）
  - `endTime` - 结束时间（日期时间选择器，必填，格式：`YYYY-MM-DD HH:mm`）
  - `remark` - 备注（文本输入，可选）

### 3.3 流程管理页面 (`src/views/ProcessCenterView.vue`)

#### 3.3.1 流程列表表格
- **显示字段：**
  - `processName` - 流程名称
  - `creationTime` - 创建时间
  - `remark` - 备注

#### 3.3.2 编辑流程抽屉
- **变量：** `editableSteps` (第 11 行) - 可编辑步骤数组
- **每个步骤字段：** 同新建流程页面的步骤字段

### 3.4 技术支持页面 (`src/views/SupportView.vue`)

#### 3.4.1 联系方式配置
- **变量：** `contacts` (第 12-17 行)
- **字段列表：**
  - `label` - 标签名称（如：'QQ', '微信', '电话', 'Email'）
  - `value` - 联系方式值（如：'123456789', 'THISIS_WECHAT'）
  - `icon` - 图标类型（'qq', 'wechat', 'phone', 'mail'）

**修改位置：**
```typescript
// src/views/SupportView.vue 第 12-17 行
const contacts = [
  { label: 'QQ', value: '123456789', icon: 'qq' },
  { label: '微信', value: 'THISIS_WECHAT', icon: 'wechat' },
  { label: '电话', value: '181-666-8881', icon: 'phone' },
  { label: 'Email', value: 'zxcv_qqq@hotmail.com', icon: 'mail' },
]
```

---

## 4. 所有按钮对应的接口路径

### 4.1 设备相关接口 (`src/api/device.ts`)

| 按钮/操作 | 函数名 | 接口路径 | 请求方法 | 说明 |
|---------|--------|---------|---------|------|
| 刷新设备列表 | `fetchDeviceList` | `/device?serial_number=ALL` | GET | 获取所有设备列表 |
| 查看设备详情 | `fetchDeviceBySerial` | `/device?serial_number={SN}` | GET | 获取单个设备详情 |
| 添加设备 | `addDevice` | `/device/add?serial_number={SN}&verification_code={CODE}` | POST | 添加新设备 |
| 下发指令 | `sendDeviceCommand` | `/device/command` | POST | 批量下发指令到设备 |

**接口详情：**

#### 4.1.1 获取设备列表
```typescript
// 函数：fetchDeviceList()
// 路径：/device
// 参数：{ serial_number: 'ALL' }
// 返回：DeviceListResponse
```

#### 4.1.2 获取设备详情
```typescript
// 函数：fetchDeviceBySerial(serialNumber: string)
// 路径：/device
// 参数：{ serial_number: serialNumber }
// 返回：DeviceDetailResponse
```

#### 4.1.3 添加设备
```typescript
// 函数：addDevice(serialNumber: string, verificationCode: string)
// 路径：/device/add
// Query参数：{ serial_number, verification_code }
// Body：{ timestamp, data: { serial_number, verification_code } }
```

#### 4.1.4 下发指令
```typescript
// 函数：sendDeviceCommand(payload: SendCommandPayload)
// 路径：/device/command
// Body：{
//   timestamp: string,
//   data: {
//     action: string,           // 动作
//     sub_action: string,       // 子动作
//     serial_numbers: string[]  // 设备序列号数组
//   }
// }
```

### 4.2 流程相关接口 (`src/api/process.ts`)

| 按钮/操作 | 函数名 | 接口路径 | 请求方法 | 说明 |
|---------|--------|---------|---------|------|
| 获取流程列表 | `fetchProcessList` | `/process/get?process_id=ALL` | GET | 获取所有流程 |
| 获取流程步骤 | `fetchProcessSteps` | `/process/get?process_id={ID}` | GET | 获取单个流程的详细步骤 |
| 创建流程 | `createProcess` | `/process/create` | POST | 创建新流程 |
| 更新流程 | `updateProcess` | `/process/update?process_id={ID}` | POST | 更新已有流程 |
| 删除流程 | `deleteProcesses` | `/process/delete` | POST | 批量删除流程 |

**接口详情：**

#### 4.2.1 获取流程列表
```typescript
// 函数：fetchProcessList()
// 路径：/process/get
// 参数：{ process_id: 'ALL' }
// 返回：ProcessListResponse
```

#### 4.2.2 获取流程步骤
```typescript
// 函数：fetchProcessSteps(processId: string)
// 路径：/process/get
// 参数：{ process_id: processId }
// 返回：ProcessStepsResponse
```

#### 4.2.3 创建流程
```typescript
// 函数：createProcess(steps: ProcessStep[])
// 路径：/process/create
// Body：{
//   timestamp: string,
//   data: [
//     {
//       step: number,
//       action: string,
//       sub_action: string,
//       start_time: string,  // ISO 8601 格式
//       end_time: string,    // ISO 8601 格式
//       remark: string
//     },
//     ...
//   ]
// }
```

#### 4.2.4 更新流程
```typescript
// 函数：updateProcess(processId: string, steps: ProcessStep[])
// 路径：/process/update
// Query参数：{ process_id: processId }
// Body：{
//   timestamp: string,
//   data: {
//     process_id: string,
//     steps: [...]
//   }
// }
```

#### 4.2.5 删除流程
```typescript
// 函数：deleteProcesses(processIds: string[])
// 路径：/process/delete
// Body：{
//   timestamp: string,
//   data: {
//     process_id: string[]  // 流程ID数组
//   }
// }
```

### 4.3 页面按钮与接口映射表

| 页面 | 按钮名称 | 触发的函数 | 接口路径 |
|-----|---------|-----------|---------|
| 设备列表 | 刷新 | `loadDevices()` | `GET /device?serial_number=ALL` |
| 设备列表 | 添加设备 | `handleAddDevice()` | `POST /device/add` |
| 设备列表 | 下发指令 | `handleSendCommand()` | `POST /device/command` |
| 设备列表 | 查看详情 | `openDetail()` | `GET /device?serial_number={SN}` |
| 设备详情 | 停止所有 | 未实现 | - |
| 设备详情 | 刷新 | `loadDeviceDetail()` | `GET /device?serial_number={SN}` |
| 新建流程 | 创建 | `handleSubmit()` | `POST /process/create` |
| 流程管理 | 删除流程 | `handleDelete()` | `POST /process/delete` |
| 流程管理 | 保存更新 | `handleSave()` | `POST /process/update?process_id={ID}` |
| 流程管理 | 查看流程 | `openProcess()` | `GET /process/get?process_id={ID}` |

---

## 5. 其他配置项

### 5.1 环境变量配置

**文件位置：** 项目根目录 `.env` 

**配置项：**
```env
# 是否使用模拟数据（true: 使用 mock 数据，false: 调用真实接口）
VITE_USE_MOCK=true

# 后端接口基础地址
# VITE_API_BASE=https://api.example.com
```

**读取位置：** `src/config/app.ts`

### 5.2 路由配置

**文件位置：** `src/router/index.ts`

**路由列表：**
- `/` - 重定向到 `/devices`
- `/devices` - 设备列表页
- `/process/new` - 新建流程页
- `/process/center` - 流程管理页
- `/support` - 技术支持页

### 5.3 菜单配置

**文件位置：** `src/App.vue` (第 17-22 行)

**菜单项：**
```typescript
const menuItems = [
  { key: '/devices', label: '设备列表', icon: DesktopOutlined },
  { key: '/process/new', label: '新建流程', icon: PlusSquareOutlined },
  { key: '/process/center', label: '流程管理', icon: ProfileOutlined },
  { key: '/support', label: '技术支持', icon: CustomerServiceOutlined },
]
```

### 5.4 系统标题

**文件位置：** `src/App.vue` (第 40 行)
- 品牌标题：`设备管理系统`

**文件位置：** `src/router/index.ts` (第 40 行)
- 页面标题格式：`${页面标题} · 设备管理系统`

### 5.5 用户信息

**文件位置：** `src/App.vue` (第 53 行)
- 用户名显示：`XXXXX 欢迎您`
- 退出登录按钮：未实现接口调用

---

## 6. 快速修改指南

### 6.1 修改动作和子动作（示例：改为推流相关）

1. 打开 `src/data/mock.ts`
2. 修改 `actionOptions`：
   ```typescript
   export const actionOptions = [
     '推流',
     '录制',
     '转码',
     // ... 其他动作
   ]
   ```
3. 修改 `subActionOptions`：
   ```typescript
   export const subActionOptions: Record<string, string[]> = {
     推流: ['音频推流', '视频推流', '混合推流'],
     录制: ['本地录制', '云端录制', '混合录制'],
     转码: ['H.264转码', 'H.265转码', '音频转码'],
     // ... 其他子动作
   }
   ```

### 6.2 修改接口地址

1. 创建 `.env` 文件（如果不存在）
2. 设置 `VITE_API_BASE`：
   ```env
   VITE_API_BASE=https://your-api-server.com
   ```
3. 重启开发服务器

### 6.3 修改技术支持联系方式

1. 打开 `src/views/SupportView.vue`
2. 修改 `contacts` 数组（第 12-17 行）：
   ```typescript
   const contacts = [
     { label: 'QQ', value: '你的QQ号', icon: 'qq' },
     { label: '微信', value: '你的微信号', icon: 'wechat' },
     { label: '电话', value: '你的电话号码', icon: 'phone' },
     { label: 'Email', value: '你的邮箱', icon: 'mail' },
   ]
   ```

---

## 7. 注意事项

1. **动作和子动作的对应关系**：修改 `actionOptions` 后，必须在 `subActionOptions` 中添加对应的 key，否则子动作下拉框会报错。

2. **接口路径修改**：如需修改接口路径，请同时更新：
   - `src/api/device.ts` 中的函数
   - `src/api/process.ts` 中的函数
   - 本文档中的路径记录

3. **时间格式**：所有时间字段统一使用 `YYYY-MM-DD HH:mm` 格式，交到后端时会自动转换为 ISO 8601 格式。

4. **模拟数据开关**：开发阶段建议使用 `VITE_USE_MOCK=true`，生产环境改为 `false` 并配置正确的 `VITE_API_BASE`。

5. **类型定义**：修改字段名称时，请同步更新 `src/types/index.ts` 中的类型定义。
